<?php

namespace SzentirasHu\Data;

class UsxCodes
{
    public const OLD_TESTAMENT = [
        '1KI' => [
            'default' => [
                '1Kir',
                '1kir'
            ],
        ],
        '1CH' => [
            'default' => [
                '1Krón',
                '1kron',
                '1krón',
                '1Kron'
            ],
        ],
        '1MA' => [
            'default' => [
                '1Mak',
                '1mak',
                '1Makk',
                '1makk',
            ],
        ],
        'GEN' => [
            'default' => [
                'Ter',
                'ter',
                '1Móz',
                '1móz',
                '1Mozes',
                '1mozes',
                '1Mózes',
                '1mózes',
                '1Moz',
                '1moz',
                'Teremtes',
                'teremtes',
                'Teremtés',
                'teremtés',
            ],
            'RUF' => [
                '1Móz',
                '1móz',
            ],
        ],
        '1SA' => [
            'default' => [
                '1Sam',
                '1Sám',
                '1Samuel',
                '1Sámuel',
                '1Sámuél',
                'Samuel1',
                'Sámuel1',
                'SamuelI',
                'SámuelI',
                '1sam',
                '1sám',
                '1samuel',
                '1sámuel',
                '1sámuél',
                'samuel1',
                'sámuel1',
                'samueli',
                'sámueli',
            ],
        ],
        '2KI' => [
            'default' => [
                '2Kir',
                '2kir'
            ],
        ],
        '2CH' => [
            'default' => [
                '2Krón',
                '2krón',
                '2kron',
                '2Kron'
            ],
        ],
        '2MA' => [
            'default' => [
                '2Mak',
                '2mak',
                '2Makk',
                '2makk',
            ],
        ],
        '3MA' => [
            'default' => [
                '3Mak',
                '3mak',
                '3Makk',
                '3makk',

            ],
        ],
        '4MA' => [
            'default' => [
                '4Mak',
                '4mak',
                '4Makk',
                '4makk',

            ],
        ],
        'LJE' => [
            'default' => [
                'JerLev',
                'jerlev',
            ]
        ],
        'EXO' => [
            'default' => [
                '2Moz',
                '2Móz',
                '2Mozes',
                '2Mózes',
                'Kiv',
                'Kivonulas',
                'Kivonulás',
                '2moz',
                '2móz',
                '2mozes',
                '2mózes',
                'kiv',
                'kivonulas',
                'kivonulás',
            ],
            'RUF' => [
                '2Móz',
                '2móz',
            ],
        ],
        '2SA' => [
            'default' => [
                '2Sam',
                '2Sám',
                '2Samuel',
                '2Sámuel',
                '2Sámuél',
                'Samuel2',
                'Sámuel2',
                'SamuelII',
                'SámuelII',
                '2sam',
                '2sám',
                '2samuel',
                '2sámuel',
                '2sámuél',
                'samuel2',
                'sámuel2',
                'samuelii',
                'sámuelii',
            ],
        ],
        'LEV' => [
            'default' => [
                '3Moz',
                '3Móz',
                '3Mozes',
                '3Mózes',
                'Lev',
                'Leviták',
                'Levitikus',
                '3moz',
                '3móz',
                '3mozes',
                '3mózes',
                'lev',
                'leviták',
                'levitikus',
            ],
            'RUF' => [
                '3Móz',
                '3móz',
            ],
        ],
        'NUM' => [
            'default' => [
                '4Moz',
                '4Móz',
                '4Mozes',
                '4Mózes',
                'Szam',
                'Szám',
                'Szamok',
                'Számok',
                '4moz',
                '4móz',
                '4mozes',
                '4mózes',
                'szam',
                'szám',
                'szamok',
                'számok',
            ],
            'RUF' => [
                '4Móz',
                '4móz',
            ],
        ],
        'DEU' => [
            'default' => [
                '5Moz',
                '5Móz',
                '5Mozes',
                '5Mózes',
                'Mtorv',
                'MTorv',
                'MTörv',
                '5moz',
                '5móz',
                '5mozes',
                '5mózes',
                'mtorv',
                'mtörv',
            ],
            'RUF' => [
                '5Móz',
                '5móz',
            ],
        ],
        'OBA' => [
            'default' => [
                'Abd',
                'abd'
            ],
        ],
        'HAG' => [
            'default' => [
                'Ag',
                'ag',
                'Agg',
                'agg',
                'Hag',
                'hag',
            ],
        ],
        'AMO' => [
            'default' => [
                'Ám',
                'ám',
                'Ámós',
                'ámós',
                'Ámosz',
                'ámosz'
            ],
        ],
        'BAR' => [
            'default' => [
                'Bár',
                'bár'
            ],
        ],
        'BEL' => [
            'default' => [
                'Bél',
                '(Bél)',
                'BelTh',
                'bél'
            ],
        ],
        'JDG' => [
            'default' => [
                'Bir',
                'bir',
                'Bír',
                'bír',
                'Birak',
                'birak',
                'Birák',
                'bírák',
                'Bírák',
                'JudgA'
            ],
        ],
        'WIS' => [
            'default' => [
                'Bölcs',
                'bölcs'
            ],
        ],
        'DAN' => [
            'default' => [
                'Dán',
                'dan',
                'DanTh'
            ],
        ],
        'SNG' => [
            'default' => [
                'En',
                'en',
                'Én',
                'én',
                'Énekek',
                'énekek',
                'ÉnekÉn',
                'énekén',
                'Ének.Én',
                'ének.én',
            ],
        ],
        'ISA' => [
            'default' => [
                'Ésa',
                'ésa',
                'Ézs',
                'ézs',
                'Iz',
                'iz'
            ],
        ],
        'EST' => [
            'default' => [
                'Esz',
                'esz',
                'Eszt',
                'eszt'
            ],
        ],
        'EZR' => [
            'default' => [
                'Ezd',
                'ezd',
                'Ezdr',
                'ezdr',
                'Ezsd',
                'ezsd',
                'Ezsdr',
                'ezsdr'
            ],
        ],
        '1ES' => [
            'default' => [
                'Ezd3',
                'ezd3'
            ],
        ],
        'EZK' => [
            'default' => [
                'Ez',
                'ez',
                'Ezek',
                'ezek',
                'Ezék',
                'ezék',
                'Ezekias',
                'ezekias',
                'Ezekiás',
                'ezekiás',
                'Ezékiás',
                'ezékiás',
                'Ezekiel',
                'ezekiel'
            ],
        ],
        'HAB' => [
            'default' => [
                'Hab',
                'hab'
            ],
        ],
        'HOS' => [
            'default' => [
                'Hós',
                'hós',
                'Oz',
                'oz',
                'Óz',
                'óz',
            ],
        ],
        'ODA' => [
            'default' => [
                'Ód',
                'ód'
            ],
        ],
        'JER' => [
            'default' => [
                'Jer',
                'jer'
            ],
        ],
        'JOB' => [
            'default' => [
                'Jo',
                'jo',
                'Jób',
                'job'
            ],
        ],
        'JOL' => [
            'default' => [
                'Joel',
                'joel',
                'Jóel',
                'jóel'
            ],
        ],
        'JON' => [
            'default' => [
                'Jón',
                'jón'
            ],
        ],
        'JOS' => [
            'default' => [
                'Jozs',
                'jozs',
                'Józs',
                'józs',
                'Jozsue',
                'jozsue',
                'Józsue',
                'józsue',
                'Józsué',
                'józsué',
                'JoshA'
            ],
        ],
        'LAM' => [
            'default' => [
                'Siralm',
                'siralm',
                'Jsir',
                'jsir',
                'Siral',
                'siral'
            ],
            'RUF' => [
                'Sir',
                'sir'
            ]
        ],
        'SIR' => [
            'default' => [
                'Sirák',
                'sirák',
                'Sirák fia',
                'sirák fia',
                'Ecclesiasticus',
                'ecclesiasticus',
                'Sir',
                'sir',
                'Sír',
                'sír'
            ],
            'SZIT' => [
                'Sir',
                'sir'
            ],
            'RUF' => [],
        ],
        'JDT' => [
            'default' => [
                'Judit',
                'judit'
            ],
            'SZIT' => [
                'Jud',
                'jud',
            ]
        ],
        'SUS' => [
            'default' => [
                'Zsuzs',
                '(Zsuzs)',
                'SusTh',
                'zsuzs',
            ],
        ],
        'MAL' => [
            'default' => [
                'Mal',
                'mal',
                'Malak',
                'malak',
            ],
        ],
        'MIC' => [
            'default' => [
                'Mik',
                'mik',
            ],
        ],
        'NAM' => [
            'default' => [
                'Náh',
                'náh',
            ],
        ],
        'NEH' => [
            'default' => [
                'Neh',
                'neh',
            ],
        ],
        'PRO' => [
            'default' => [
                'Péld',
                'péld'
            ],
        ],
        'ECC' => [
            'default' => [
                'Préd',
                'préd'
            ],
        ],
        'RUT' => [
            'default' => [
                'Rut',
                'rut',
                'Rút',
                'rút',
                'Ruth',
                'ruth',
                'Rúth',
                'ruth',
            ],
        ],
        'ZEP' => [
            'default' => [
                'Sof',
                'sof',
                'Szof',
                'szof',
                'Zof',
                'zof'
            ],
        ],
        'TOB' => [
            'default' => [
                'Tób',
                'tob',
                'TobBA'
            ],
        ],
        'ZEC' => [
            'default' => [
                'Zak',
                'zak',
            ],
        ],
        'PSA' => [
            'default' => [
                'Zsolt',
                'zsolt',
                'Zsoltar',
                'zsoltar',
                'Zsoltár',
                'zsoltár',
                'Zsoltarok',
                'zsoltarok',
                'Zsoltárok',
                'zsoltárok',
            ],
        ],
        'PSS' => [
            'default' => ['SalZsolt', 'salzsolt',]
        ]
    ];

    public const NEW_TESTAMENT = [
        '1JN' => [
            'default' => [
                '1Jan',
                '1Ján',
                '1Janos',
                '1János',
                '1Jn',
                '1jan',
                '1ján',
                '1janos',
                '1jános',
                '1jn',
            ],
        ],
        '2JN' => [
            'default' => [
                '2Jan',
                '2Ján',
                '2Janos',
                '2János',
                '2Jn',
                '2jan',
                '2ján',
                '2janos',
                '2jános',
                '2jn',
            ],
        ],
        '3JN' => [
            'default' => [
                '3Ján',
                '3Jn',
                '3Jan',
                '3János',
                '3jan',
                '3ján',
                '3jános',
                '3jn',
            ],
        ],
        'MAT' => [
            'default' => [
                'Mat',
                'Mát',
                'Mate',
                'Máté',
                'Mt',
                'mat',
                'mát',
                'mate',
                'máté',
                'mt',
            ],
        ],
        'MRK' => [
            'default' => [
                'Mar',
                'Már',
                'Mark',
                'Márk',
                'Mk',
                'mark',
                'márk',
                'mk',
            ],
        ],
        'LUK' => [
            'default' => [
                'Lk',
                'Luk',
                'Lukacs',
                'Lukács',
                'luk',
                'lukacs',
                'lukács',
                'lk',
            ],
        ],
        'JHN' => [
            'default' => [
                'Jan',
                'Ján',
                'Janos',
                'János',
                'Jn',
                'János',
                'jan',
                'ján',
                'janos',
                'jános',
                'jn',
            ],
        ],
        'ACT' => [
            'default' => [
                'ApCsel',
                'Csel',
                'Acs',
                'apcsel',
                'csel',
                'acs',
            ],
        ],
        'ROM' => [
            'default' => [
                'Rom', 'rom',
                'Róm', 'róm',
            ],
        ],
        '1CO' => [
            'default' => [
                '1Kor', '1kor'
            ],
        ],
        '2CO' => [
            'default' => [
                '2Kor', '2kor'
            ],
        ],
        'GAL' => [
            'default' => [
                'Gal', 'gal'
            ],
        ],
        'EPH' => [
            'default' => [
                'Ef', 'ef',
                'Eféz', 'eféz'
            ],
        ],
        'PHP' => [
            'default' => [
                'Fil', 'fil'
            ],
        ],
        'COL' => [
            'default' => [
                'Kol', 'kol'
            ],
        ],
        '1TH' => [
            'default' => [
                '1Tessz', '1tessz',
                '1Tesz', '1tesz',
                '1Thess', '1thess',
                '1Thessz', '1thessz',
            ],
        ],
        '2TH' => [
            'default' => [
                '2Tessz', '2tessz',
                '2Tesz', '2tesz',
                '2Thess', '2thess', 
                '2Thessz', '2thessz'
            ],
        ],
        '1TI' => [
            'default' => [
                '1Tim', '1tim'
            ],
        ],
        '2TI' => [
            'default' => [
                '2Tim', '2tim'
            ],
        ],
        'TIT' => [
            'default' => [
                'Tit', 'tit',
                'Tít', 'tít'
            ],
        ],
        'PHM' => [
            'default' => [
                'Filem', 'filem'
            ],
        ],
        'HEB' => [
            'default' => [
                'Zs', 'zs',
                'Zsid', 'zsid'
            ],
        ],
        'JAS' => [
            'default' => [
                'Jak', 'jak'
            ],
        ],
        '1PE' => [
            'default' => [
                '1Pét', '1pét',
                '1Pt', '1pt'
            ],
        ],
        '2PE' => [
            'default' => [
                '2Pét', '2pét',
                '2Pt', '2pt'
            ],
        ],
        'JUD' => [
            'default' => [
                'Jud', 'jud',
                'Júd', 'júd',
                'Júdás', 'júdás'
            ],
        ],
        'REV' => [
            'default' => [
                'Jel', 'jel'
            ],
        ],
    ];

    public static function oldTestamentUsx(): array
    {
        return array_keys(UsxCodes::OLD_TESTAMENT);
    }

    public static function newTestamentUsx(): array
    {
        return array_keys(UsxCodes::NEW_TESTAMENT);
    }

    public static function allUsx(): array
    {
        return array_merge(UsxCodes::oldTestamentUsx(), UsxCodes::newTestamentUsx());
    }

    public static function getUsxFromBookAbbrevAndTranslation(string $bookAbbrev, string $translation = "default"): ?string
    {
        static $abbrevToUsxPerTranslation = null;
        static $usxToTranslationToAbbrev = null;
        if ($abbrevToUsxPerTranslation === null) {
            $usxToTranslationToAbbrev = self::fullMapping();
            $abbrevToUsxPerTranslation = self::abbrevToUsxPerTranslation($usxToTranslationToAbbrev);
        }

        if (isset($abbrevToUsxPerTranslation[$translation][$bookAbbrev])) {
            return $abbrevToUsxPerTranslation[$translation][$bookAbbrev];
        }

        if (isset($abbrevToUsxPerTranslation["default"][$bookAbbrev])) {
            $specificUsx = $abbrevToUsxPerTranslation["default"][$bookAbbrev];

            if (
                isset($usxToTranslationToAbbrev[$specificUsx][$translation]) &&
                $usxToTranslationToAbbrev[$specificUsx][$translation] === []
            ) {
                return null; // no such book in this translation
            }

            return $specificUsx;
        }

        return null; // unknown book
    }

    public static function getAbbreviations(string $usxCode, string $translation): array
    {
        if (isset(UsxCodes::fullMapping()[$usxCode][$translation])) {
            return UsxCodes::fullMapping()[$usxCode][$translation];
        }
        if (isset(UsxCodes::fullMapping()[$usxCode]["default"])) {
            return UsxCodes::fullMapping()[$usxCode]["default"];
        }
        return [];
    }

    public static function getPreferredAbbreviation(string $usxCode, string $translation): ?string
    {
        $abbreviations = UsxCodes::getAbbreviations($usxCode, $translation);
        if (count($abbreviations) > 0) {
            return $abbreviations[0];
        } else {
            return null;
        }
    }

    private static function fullMapping(): array
    {
        return array_merge(UsxCodes::OLD_TESTAMENT, UsxCodes::NEW_TESTAMENT);
    }

    private static function abbrevToUsxPerTranslation($inputMap): array
    {
        $outputMap = [];
        foreach ($inputMap as $usx => $translations) {
            foreach ($translations as $translationName => $abbrevs) {
                if (!isset($outputMap[$translationName])) {
                    $outputMap[$translationName] = [];
                }
                foreach ($abbrevs as $abbrev) {
                    $outputMap[$translationName][$abbrev] = $usx;
                }
            }
        }
        return $outputMap;
    }
}
